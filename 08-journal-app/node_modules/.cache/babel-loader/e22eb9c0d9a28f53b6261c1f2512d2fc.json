{"ast":null,"code":"import _objectSpread from\"C:/Users/Jos\\xE9 Luis/Desktop/React/08-journal-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"C:/Users/Jos\\xE9 Luis/Desktop/React/08-journal-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/Jos\\xE9 Luis/Desktop/React/08-journal-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import Swal from'sweetalert2';import{db}from'../firebase/firebaseConfig';import{fileUpload}from'../helpers/fileUpload';import{loadNotes}from'../helpers/loadNotes';import types from'../types/types';export var startNewNote=function startNewNote(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch,getState){var uid,newNote,doc;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:uid=getState().auth.uid;newNote={title:'',body:'',date:new Date().getTime()};_context.next=4;return db.collection(\"\".concat(uid,\"/journal/notes\")).add(newNote);case 4:doc=_context.sent;dispatch(activeNote(doc.id,newNote));dispatch(addNewNote(doc.id,newNote));case 7:case\"end\":return _context.stop();}}},_callee);}));return function(_x,_x2){return _ref.apply(this,arguments);};}();};export var activeNote=function activeNote(id,note){return{type:types.notesActive,payload:_objectSpread({id:id},note)};};export var addNewNote=function addNewNote(id,note){return{type:types.notesAddNew,payload:_objectSpread({id:id},note)};};export var startLoadingNotes=function startLoadingNotes(uid){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var notes;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return loadNotes(uid);case 2:notes=_context2.sent;dispatch(setNotes(notes));case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x3){return _ref2.apply(this,arguments);};}();};export var setNotes=function setNotes(notes){return{type:types.notesLoad,payload:notes};};export var startSaveNote=function startSaveNote(note){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch,getState){var uid,noteToFirestore;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:uid=getState().auth.uid;if(!note.url){delete note.url;}noteToFirestore=_objectSpread({},note);delete noteToFirestore.id;_context3.next=6;return db.doc(\"\".concat(uid,\"/journal/notes/\").concat(note.id)).update(noteToFirestore).catch(function(){return Swal.fire('Oops!','Something went wrong, try saving your note again!','error');});case 6:dispatch(refreshNote(note.id,noteToFirestore));Swal.fire('Saved',\"Note with title \\\"\".concat(note.title,\"\\\" saved successfully!\"),'success');case 8:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x4,_x5){return _ref3.apply(this,arguments);};}();};export var refreshNote=function refreshNote(id,note){return{type:types.notesUpdated,payload:{id:id,note:_objectSpread({id:id},note)}};};export var startUploading=function startUploading(file){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch,getState){var activeNote,fileUrl;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:activeNote=getState().notes.active;Swal.fire({title:'Uploading...',text:'Please wait...',allowOutsideClick:false,showConfirmButton:false,willOpen:function willOpen(){Swal.showLoading();}});_context4.next=4;return fileUpload(file);case 4:fileUrl=_context4.sent;activeNote.url=fileUrl;dispatch(startSaveNote(activeNote));Swal.close();case 8:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x6,_x7){return _ref4.apply(this,arguments);};}();};export var startDeleting=function startDeleting(id){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch,getState){var uid;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:uid=getState().auth.uid;_context5.next=3;return db.doc(\"\".concat(uid,\"/journal/notes/\").concat(id)).delete();case 3:dispatch(deleteNote(id));case 4:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x8,_x9){return _ref5.apply(this,arguments);};}();};export var deleteNote=function deleteNote(id){return{type:types.notesDelete,payload:id};};export var noteLogout=function noteLogout(){return{type:types.notesLogoutCleaning};};","map":{"version":3,"sources":["C:/Users/JosÃ© Luis/Desktop/React/08-journal-app/src/actions/notes.js"],"names":["Swal","db","fileUpload","loadNotes","types","startNewNote","dispatch","getState","uid","auth","newNote","title","body","date","Date","getTime","collection","add","doc","activeNote","id","addNewNote","note","type","notesActive","payload","notesAddNew","startLoadingNotes","notes","setNotes","notesLoad","startSaveNote","url","noteToFirestore","update","catch","fire","refreshNote","notesUpdated","startUploading","file","active","text","allowOutsideClick","showConfirmButton","willOpen","showLoading","fileUrl","close","startDeleting","delete","deleteNote","notesDelete","noteLogout","notesLogoutCleaning"],"mappings":"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","sourcesContent":["import Swal from 'sweetalert2';\r\n\r\nimport { db } from '../firebase/firebaseConfig';\r\nimport { fileUpload } from '../helpers/fileUpload';\r\nimport { loadNotes } from '../helpers/loadNotes';\r\nimport types from '../types/types';\r\n\r\nexport const startNewNote = () => {\r\n    return async (dispatch, getState) => {\r\n\r\n        const uid = getState().auth.uid\r\n\r\n        const newNote = {\r\n            title: '',\r\n            body: '',\r\n            date: new Date().getTime()\r\n        }\r\n\r\n        const doc = await db.collection(`${uid}/journal/notes`).add(newNote);\r\n\r\n        dispatch( activeNote(doc.id, newNote) );\r\n        dispatch( addNewNote(doc.id, newNote) );\r\n\r\n    }\r\n\r\n}\r\n\r\nexport const activeNote = (id, note) => ({\r\n\r\n    type: types.notesActive,\r\n    payload: {\r\n        id,\r\n        ...note\r\n    }\r\n\r\n});\r\n\r\nexport const addNewNote = (id, note) => ({\r\n    type: types.notesAddNew,\r\n    payload: {\r\n        id,\r\n        ...note\r\n    }\r\n})\r\n\r\nexport const startLoadingNotes = (uid) => {\r\n\r\n    return async (dispatch) => {\r\n        const notes = await loadNotes(uid);\r\n        dispatch( setNotes(notes) );\r\n    }\r\n}\r\n\r\nexport const setNotes = (notes) => ({\r\n\r\n    type: types.notesLoad,\r\n    payload: notes\r\n\r\n});\r\n\r\nexport const startSaveNote = ( note ) => {\r\n\r\n    return async (dispatch, getState) => {\r\n\r\n        const uid = getState().auth.uid\r\n\r\n        if ( !note.url ) {\r\n            delete note.url;\r\n        }\r\n\r\n        const noteToFirestore = { ...note };\r\n        delete noteToFirestore.id;\r\n\r\n        await db.doc(`${uid}/journal/notes/${note.id}`).update(noteToFirestore)\r\n            .catch(() => Swal.fire('Oops!', 'Something went wrong, try saving your note again!', 'error') );\r\n\r\n        dispatch( refreshNote(note.id, noteToFirestore) );\r\n        Swal.fire('Saved', `Note with title \"${note.title}\" saved successfully!`, 'success');\r\n\r\n    }\r\n\r\n}\r\n\r\nexport const refreshNote = (id, note) => ({\r\n    type: types.notesUpdated,\r\n    payload: {\r\n        id,\r\n        note: {\r\n            id,\r\n            ...note\r\n        }\r\n    }\r\n});\r\n\r\nexport const startUploading = (file) => {\r\n\r\n    return async (dispatch, getState) => {\r\n\r\n        const { active: activeNote } = getState().notes;\r\n\r\n        Swal.fire({\r\n            title: 'Uploading...',\r\n            text: 'Please wait...',\r\n            allowOutsideClick: false,\r\n            showConfirmButton: false,\r\n            willOpen: () => {\r\n                Swal.showLoading();\r\n            }\r\n        });\r\n\r\n        const fileUrl = await fileUpload(file);\r\n        activeNote.url = fileUrl;\r\n\r\n        dispatch( startSaveNote(activeNote) );\r\n\r\n        Swal.close();\r\n\r\n    }\r\n\r\n}\r\n\r\nexport const startDeleting = (id) => {\r\n    return async (dispatch, getState) => {\r\n\r\n        const uid = getState().auth.uid;\r\n        await db.doc(`${uid}/journal/notes/${id}`).delete();\r\n\r\n        dispatch( deleteNote(id) );\r\n\r\n    }\r\n}\r\n\r\nexport const deleteNote = (id) => ({\r\n\r\n    type: types.notesDelete,\r\n    payload: id\r\n\r\n});\r\n\r\nexport const noteLogout = () => ({\r\n    type: types.notesLogoutCleaning,\r\n});"]},"metadata":{},"sourceType":"module"}