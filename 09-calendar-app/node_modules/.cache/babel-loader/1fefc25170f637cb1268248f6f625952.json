{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Jos\\xE9 Luis/Desktop/React/09-calendar-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/Jos\\xE9 Luis/Desktop/React/09-calendar-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import Swal from\"sweetalert2\";import{fetchNoToken,fetchToken}from\"../helpers/fetch\";import{types}from\"../types/types\";export var startLogin=function startLogin(email,password){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var response,body;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetchNoToken('auth',{email:email,password:password},'POST');case 2:response=_context.sent;_context.next=5;return response.json();case 5:body=_context.sent;if(body.ok){localStorage.setItem('token',body.token);localStorage.setItem('token-init-date',new Date().getTime());dispatch(login({uid:body.uid,name:body.name}));}else{Swal.fire('Error',body.msg,'error');}case 7:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var startRegister=function startRegister(email,password,name){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response,body;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetchNoToken('auth/new',{email:email,password:password,name:name},'POST');case 2:response=_context2.sent;_context2.next=5;return response.json();case 5:body=_context2.sent;if(body.ok){localStorage.setItem('token',body.token);localStorage.setItem('token-init-date',new Date().getTime());dispatch(login({uid:body.uid,name:body.name}));}else{Swal.fire('Error',body.msg,'error');};case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var startChecking=function startChecking(){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var response,body;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetchToken('auth/renew');case 2:response=_context3.sent;_context3.next=5;return response.json();case 5:body=_context3.sent;if(body.ok){localStorage.setItem('token',body.token);localStorage.setItem('token-init-date',new Date().getTime());dispatch(login({uid:body.uid,name:body.name}));}else{dispatch(checkingFinish());};case 8:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};var checkingFinish=function checkingFinish(){return{type:types.authCheckingFinish};};var login=function login(user){return{type:types.authLogin,payload:user};};export var startLogout=function startLogout(){return function(dispatch){localStorage.clear();dispatch(logout());};};var logout=function logout(){return{type:types.authLogout};};","map":{"version":3,"sources":["C:/Users/JosÃ© Luis/Desktop/React/09-calendar-app/src/actions/auth.js"],"names":["Swal","fetchNoToken","fetchToken","types","startLogin","email","password","dispatch","response","json","body","ok","localStorage","setItem","token","Date","getTime","login","uid","name","fire","msg","startRegister","startChecking","checkingFinish","type","authCheckingFinish","user","authLogin","payload","startLogout","clear","logout","authLogout"],"mappings":"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","sourcesContent":["import Swal from \"sweetalert2\";\r\n\r\nimport { fetchNoToken, fetchToken } from \"../helpers/fetch\";\r\nimport { types } from \"../types/types\";\r\n\r\nexport const startLogin = (email, password) => {\r\n\r\n    return async (dispatch) => {\r\n\r\n        const response = await fetchNoToken('auth', { email, password }, 'POST');\r\n        const body = await response.json();\r\n\r\n        if (body.ok) {\r\n\r\n            localStorage.setItem( 'token', body.token );\r\n            localStorage.setItem( 'token-init-date', new Date().getTime() );\r\n\r\n            dispatch(login({\r\n                uid: body.uid,\r\n                name: body.name\r\n            }));\r\n\r\n        } else {\r\n            Swal.fire('Error', body.msg, 'error');\r\n        }\r\n    };\r\n};\r\n\r\nexport const startRegister = (email, password, name) => {\r\n    return async (dispatch) => {\r\n\r\n        const response = await fetchNoToken('auth/new', { email, password, name }, 'POST');\r\n        const body = await response.json();\r\n\r\n        if (body.ok) {\r\n\r\n            localStorage.setItem( 'token', body.token );\r\n            localStorage.setItem( 'token-init-date', new Date().getTime() );\r\n\r\n            dispatch(login({\r\n                uid: body.uid,\r\n                name: body.name\r\n            }));\r\n\r\n        } else {\r\n            Swal.fire('Error', body.msg, 'error');\r\n        };\r\n    };\r\n};\r\n\r\nexport const startChecking = () => {\r\n\r\n    return async (dispatch) => {\r\n        const response = await fetchToken('auth/renew');\r\n        const body = await response.json();\r\n\r\n        if (body.ok) {\r\n\r\n            localStorage.setItem( 'token', body.token );\r\n            localStorage.setItem( 'token-init-date', new Date().getTime() );\r\n\r\n            dispatch(login({\r\n                uid: body.uid,\r\n                name: body.name\r\n            }));\r\n\r\n        } else {\r\n            dispatch( checkingFinish() );\r\n        };\r\n    };\r\n\r\n}\r\n\r\nconst checkingFinish = () => ({ type: types.authCheckingFinish });\r\n\r\nconst login = (user) => ({\r\n    type: types.authLogin,\r\n    payload: user\r\n});\r\n\r\nexport const startLogout = () => {\r\n    return (dispatch) => {\r\n\r\n        localStorage.clear();\r\n        dispatch( logout() );\r\n\r\n    };\r\n\r\n};\r\n\r\nconst logout = () => ({ type: types.authLogout });"]},"metadata":{},"sourceType":"module"}